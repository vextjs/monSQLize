# plans/ 目录使用说明

> **说明**: 本目录用于存储 monSQLize 的需求详细文档  
> **规范**: 遵循 AI 开发规范 v4.6 - 文档规范 § 3.4

---

## 📑 目录结构

```
plans/
├── TEMPLATE.md              # 需求文档模板
├── README.md                # 本文件
├── req-xxx.md               # 新功能需求
├── bug-xxx.md               # Bug 修复
├── opt-xxx.md               # 性能优化
├── ref-xxx.md               # 代码重构
├── sec-xxx.md               # 安全加固
├── db-xxx.md                # 数据库变更
└── api-xxx.md               # API 开发
```

---

## 🏷️ 文件命名规范

### 命名格式

`{类型前缀}-{功能描述}.md`

### 类型前缀

| 前缀 | 说明 | 示例 |
|------|------|------|
| req- | 新功能需求 | req-watch-feature.md |
| bug- | Bug 修复 | bug-cache-memory-leak.md |
| opt- | 性能优化 | opt-query-performance.md |
| ref- | 代码重构 | ref-transaction-manager.md |
| sec- | 安全加固 | sec-sql-injection-fix.md |
| db- | 数据库变更 | db-add-index.md |
| api- | API 开发 | api-new-endpoints.md |

### 命名规则

- ✅ 全小写英文
- ✅ 连字符分隔
- ✅ 20个字符以内
- ✅ 描述准确简洁
- ❌ 禁止纯编号（如 req-001.md）
- ❌ 禁止中文（如 req-监听功能.md）

---

## 📝 创建需求文档

### 步骤1：复制模板

```bash
cp plans/TEMPLATE.md plans/req-your-feature.md
```

### 步骤2：填充内容

必须填充的章节：
- ✅ 需求概述
- ✅ 目标
- ✅ 方案设计
- ✅ 实现清单
- ✅ 影响范围
- ✅ 验证方式

### 步骤3：添加到 STATUS.md

在对应版本表格添加一行：

```markdown
| 需求标题 | 状态 | 优先级 | 详细 |
|---------|------|--------|------|
| 监听功能 | 🚧 开发中 | P1 | [详细](plans/req-watch-feature.md) |
```

### 步骤4：更新状态

开发进度更新：
- 💡 提议 → 📋 计划中 → 🚧 开发中 → ✅ 已完成

---

## 🔗 文档关联

### 正向追溯（用户视角）

```
CHANGELOG.md（版本摘要）
     ↓
STATUS.md（版本需求列表）
     ↓
plans/req-xxx.md（需求详细）
```

### 反向追溯（开发视角）

```
plans/req-xxx.md
     ↓
STATUS.md（查看版本状态）
     ↓
CHANGELOG.md（查看版本摘要）
```

---

## 📊 需求文档清单

> **说明**: 以下列表由 AI 自动维护

### v1.2.0（开发中）

| 需求文档 | 需求标题 | 状态 | 优先级 |
|---------|---------|------|--------|
| - | - | - | - |

### v1.1.0（已发布）

| 需求文档 | 需求标题 | 状态 | 优先级 |
|---------|---------|------|--------|
| - | watch (Change Streams) | ✅ 已完成 | P1 |

### v1.0.0（已发布）

| 需求文档 | 需求标题 | 状态 | 优先级 |
|---------|---------|------|--------|
| - | 正式发布 | ✅ 已完成 | P0 |

---

## 🛠️ 维护规范

### 创建时机

**AI 自动判断需要创建 plans/ 文档的场景**：

✅ **强制创建**：
- 意图02（开发新功能）
- 意图06（安全加固）
- 意图07（数据库变更）
- 意图08（API开发）
- 意图09（配置变更 Level 3）
- 影响文件 > 3个
- 涉及数据库变更
- 涉及API变更
- 风险等级为 P0

⚠️ **询问用户**：
- 意图03（修复Bug）
- 意图04（代码重构）
- 意图05（性能优化）
- 意图09（配置变更 Level 2）
- 意图15（脚本开发）
- 涉及架构调整

❌ **不创建**：
- 意图01（简单问答）
- 意图09（配置变更 Level 1）
- 意图11（仅测试）
- 意图12（仅文档）
- 意图13（代码审查）

### 更新时机

- **开发开始时**: 状态改为 🚧 开发中
- **开发完成时**: 状态改为 ✅ 已完成，填充完成日期
- **版本发布时**: 添加版本标记

### 清理规则

- ✅ 保留所有需求文档（包括已完成）
- ✅ 可以归档到子目录（如 `plans/archive/v1.0.0/`）
- ❌ 禁止删除需求文档

---

## 📎 相关资源

- [STATUS.md](../STATUS.md) - 需求状态追踪
- [CHANGELOG.md](../CHANGELOG.md) - 版本摘要
- [文档规范](https://link-to-guidelines) - AI 开发规范 v4.6

---

**最后更新**: 2025-12-12  
**文档版本**: 1.0  
**维护者**: AI 开发助手

